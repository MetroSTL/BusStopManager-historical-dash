(this.webpackJsonphistorical=this.webpackJsonphistorical||[]).push([[0],{51:function(e,t,s){},52:function(e,t,s){},53:function(e,t,s){},76:function(e,t,s){"use strict";s.r(t);var r=s(2),n=s(0),a=s.n(n),c=s(9),o=s.n(c),i=(s(51),s(12)),l=(s(52),s(53),s(8)),u=s.n(l),d=s(11),b=s(106),j=s(110);var p=function(e){var t=e.stops,s=e.setStopSelection,a=e.setSurveyDetails;function c(){return(c=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(t),a("");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=console,e.next=3,t;case 3:e.t1=e.sent,e.t0.log.call(e.t0,"AllStops",e.t1);case 5:case"end":return e.stop()}}),e)}))),[t]),Object(r.jsxs)("div",{className:"panel",children:[Object(r.jsx)("h2",{className:"text-lg my-4 underline",children:"Matching Stops"}),Object(r.jsx)("div",{className:"m-0 w-100",children:t?t.map((function(e){return Object(r.jsxs)("li",{className:"item flex flex-column border-b-2 py-6 m-0 w-100",onClick:function(t){return function(e){return c.apply(this,arguments)}(e.attributes.stopid)},children:[e.attributes.routes?Object(r.jsx)(b.a,{className:" align-middle",color:"primary"}):Object(r.jsx)(j.a,{color:"secondary",className:" align-middle"}),Object(r.jsx)("li",{className:"flex flex-column mx-auto text-left w-5/6 px-2",children:Object(r.jsxs)("ul",{children:[Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"StopID: "})," "," "+e.attributes.stopid]}),Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"StopName: "})," ",e.attributes.stopname]}),Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"Status: "})," ",e.attributes.routes?"Active":"Ghoststop"]})]})})]},e.attributes.stopid)})):""})]})};function f(e){var t=new Date(e),s=("0"+t.getDate()).slice(-2);return("0"+(t.getMonth()+1)).slice(-2)+"/"+s+"/"+t.getFullYear().toString().substr(2,2)}function h(e){var t=e.stopIDHistory,s=e.setSurveyDetails;return Object(n.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=console,e.next=3,t;case 3:e.t1=e.sent,e.t0.log.call(e.t0,"StopHistoryID",e.t1);case 5:case"end":return e.stop()}}),e)}))),[t]),Object(r.jsxs)("div",{className:"panel",children:[Object(r.jsx)("h2",{className:"text-lg my-4 underline",children:"Stop History"}),t?t.map((function(e){return Object(r.jsx)("a",{className:"item flex flex-column border-b-2 py-6 m-0 w-100",onClick:function(t){return function(e){console.log(e),s(e)}(e)},children:Object(r.jsx)("li",{className:"flex flex-column mx-auto text-left w-5/6 px-2",children:Object(r.jsxs)("ul",{children:[Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"StopID: "})," "," "+e.attributes.stop_id]}),Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"StopName: "})," ",e.attributes.stop_name]}),Object(r.jsxs)("li",{className:"flex flex-row ",children:[Object(r.jsx)("b",{children:"Last Edit: "})," ","".concat(f(e.attributes.last_edited_date))]})]})})},e.attributes.stop_id)})):""]})}function m(e){var t=e.surveyDetails,s=e.setShowSurvey,n=e.setSurveyURL,a=(e.surveyURL,e.token);return Object(r.jsxs)("div",{className:"panel",children:[Object(r.jsx)("h2",{className:"text-lg my-4 underline",children:"Survey Record"}),t?Object(r.jsxs)("div",{children:[Object(r.jsxs)("h3",{children:[Object(r.jsx)("b",{children:"Stop ID: "}),t.attributes.stop_id]}),Object(r.jsxs)("h3",{children:[Object(r.jsx)("b",{children:"Stop Name: "}),t.attributes.stop_name]}),Object(r.jsxs)("h3",{children:[Object(r.jsx)("b",{children:"Bench: "}),t.attributes.bench]}),Object(r.jsxs)("h3",{children:[Object(r.jsx)("b",{children:"Shelter: "}),t.attributes.shelter]}),Object(r.jsxs)("h3",{children:[Object(r.jsx)("b",{children:"Last Edit Date: "}),f(parseInt(1609185748773))]}),Object(r.jsx)("button",{className:"border-2 p-5 ml-3 mt-3",onClick:function(e){return r=t.attributes.globalid,console.log(r),n("https://survey123.arcgis.com/share/".concat("5112a8568fc34207b4a1b6b8c3777633","?portalUrl=").concat("https://maps.metrostlouis.org/arcgis","&mode=edit&globalId=").concat(r,"&token=").concat(a)),void s(!0);var r},children:"Full Survey"})]}):""]})}function x(e){var t=e.setShowCloseAlert,s=e.setShowSurvey;e.setSurveyURL;return Object(r.jsxs)("div",{className:"bg-white w-1/2 h-1/2 p-4 rounded-md border-2 absolute boarder-black",style:{top:"50%",left:"50%",transform:"translateX(-50%)"},children:[Object(r.jsx)("h2",{children:"Would you like to close the survey? All unsaved data will be lost"}),Object(r.jsx)("button",{className:"border-2 p-5 ml-3 mt-3 boarder-black",onClick:function(e){return function(e){e.preventDefault(),t(!1),s(!1)}(e)},children:"Yes"}),Object(r.jsx)("button",{className:"border-2 p-5 ml-3 mt-3 boarder-black",onClick:function(e){return function(e){e.preventDefault(),t(!1)}(e)},children:"No"})]})}function O(e){var t=e.surveyURL,s=e.setShowSurvey,a=(e.setSurveyURL,Object(n.useState)(!1)),c=Object(i.a)(a,2),o=c[0],l=c[1];return Object(r.jsxs)("div",{id:"popup-survey",className:"bg-white w-3/4 h-2/3 absolute bg-white w-1/2 h-full p-4 rounded-md border-2 absolute",style:{top:"5%",right:"15%",height:"85vh"},children:[Object(r.jsx)("iframe",{className:"w-full h-full",src:t}),Object(r.jsx)("div",{id:"close-iframe",children:Object(r.jsx)("button",{className:"border-2 p-5 ml-3 mt-8 boarder-black",onClick:function(e){return l(!0)},children:"Close"})}),o?Object(r.jsx)(x,{setShowSurvey:s,setShowCloseAlert:l}):""]})}var v=s(30),y=s(111);var S=function(e){var t,s=e.setSearch,n=e.setStopIDHistory;return Object(r.jsx)("div",{id:"init-search",className:"w-70",style:{marginLeft:"auto",marginRight:"auto"},children:Object(r.jsx)("form",{id:"form-search",className:"px-40 black-80",children:Object(r.jsx)("div",(t={className:"measure"},Object(v.a)(t,"className","mx-auto pt-3"),Object(v.a)(t,"children",Object(r.jsx)(y.a,{onChange:function(e){return function(e){e.preventDefault(),n(""),s(e.target.value)}(e)},id:"standard-search",label:"StopID Search",type:"number"})),t))})})},g=s(22),w=s.n(g),C=function(){var e=Object(d.a)(u.a.mark((function e(t,s){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://maps.metrostlouis.org/arcserver/rest/services/Hosted/MetroBusStops_REGISTERED/FeatureServer/0/query?where=cast%28stopid+as+varchar%2810%29%29+LIKE+%27%25".concat(s,"%25%27&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&distance=&units=esriSRUnit_Foot&relationParam=&outFields=signid%2C+stopid%2C+stopname%2C+onst%2C+atst%2C+routes%2C+gps_lat%2C+gps_lon&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&havingClause=&gdbVersion=&historicMoment=&returnDistinctValues=false&returnIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&multipatchOption=xyFootprint&resultOffset=&resultRecordCount=&returnTrueCurves=false&returnCentroid=false&sqlFormat=none&resultType=&datumTransformation=&f=pjson&token=").concat(t),n="https://maps.metrostlouis.org/arcserver/rest/services/Hosted/MetroBusGhostStops_REGISTERED/FeatureServer/0/query?where=cast%28stopid+as+varchar%2810%29%29+LIKE+%27%25".concat(s,"%25%27&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&distance=&units=esriSRUnit_Foot&relationParam=&outFields=signid%2C+stopid%2C+stopname%2C+onst%2C+atst%2C+gps_lat%2C+gps_lon&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&havingClause=&gdbVersion=&historicMoment=&returnDistinctValues=false&returnIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&multipatchOption=xyFootprint&resultOffset=&resultRecordCount=&returnTrueCurves=false&returnCentroid=false&sqlFormat=none&resultType=&datumTransformation=&f=pjson&token=").concat(t),e.next=4,w.a.get(r).then((function(e){return e.data.features})).then(function(){var e=Object(d.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get(n).then((function(e){return e.data.features}));case 2:return s=e.sent,e.t0=t,e.next=6,s;case 6:return e.t1=e.sent,e.next=9,e.t0.concat.call(e.t0,e.t1);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return a=e.sent,e.next=7,a;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(u.a.mark((function e(t,s){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://maps.metrostlouis.org/arcserver/rest/services/Hosted/bus_stop_manager_fc_View/FeatureServer/0/query?where=cast%28stop_id+as+varchar%2810%29%29+LIKE+%27%25".concat(s,"%25%27&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&distance=&units=esriSRUnit_Foot&relationParam=&outFields=*&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&havingClause=&gdbVersion=&historicMoment=&returnDistinctValues=false&returnIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&multipatchOption=xyFootprint&resultOffset=&resultRecordCount=&returnTrueCurves=false&returnCentroid=false&sqlFormat=none&resultType=&datumTransformation=&f=pjson&token=").concat(t),e.next=3,w.a.get(r).then((function(e){return e.data.features}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}();function N(e){var t=Object(n.useState)(""),s=Object(i.a)(t,2),a=s[0],c=s[1],o=Object(n.useState)(""),l=Object(i.a)(o,2),b=l[0],j=l[1],f=Object(n.useState)(""),x=Object(i.a)(f,2),v=x[0],y=x[1],g=Object(n.useState)(""),w=Object(i.a)(g,2),N=w[0],I=w[1],R=Object(n.useState)([]),F=Object(i.a)(R,2),D=F[0],E=F[1],_=Object(n.useState)(!1),L=Object(i.a)(_,2),T=L[0],U=L[1],M=Object(n.useState)(""),B=Object(i.a)(M,2),G=B[0],A=B[1],H=e.token;return Object(n.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y([]),j(""),I(""),E([]);case 4:case"end":return e.stop()}}),e)}))),[]),Object(n.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>2)){e.next=8;break}return e.t0=E,e.next=4,C(H,a);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=9;break;case 8:E([]);case 9:case"end":return e.stop()}}),e)}))),[a]),Object(n.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=y,e.next=3,k(H,b);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)}))),[b]),Object(r.jsxs)("div",{className:"",children:[Object(r.jsx)("div",{className:"w-100 flex search",children:Object(r.jsx)(S,{setSearch:c,setStopIDHistory:y})}),Object(r.jsxs)("div",{className:"flex dashboard",children:[Object(r.jsx)(p,{token:H,setStopSelection:j,setSurveyDetails:I,stops:D}),Object(r.jsx)(h,{stopIDHistory:v,setSurveyDetails:I}),Object(r.jsx)(m,{surveyDetails:N,setShowSurvey:U,setSurveyURL:A,surveyURL:G,token:H}),T?Object(r.jsx)(O,{surveyURL:G,setShowSurvey:U}):""]})]})}var I=s.p+"static/media/metrologo.2030a298.png",R=s.p+"static/media/login.c1b9acc4.svg";function F(e){var t=e.signedIn,s=e.setUser,a=e.user,c=e.token,o=e.setToken,i=e.setSignedIn;return Object(n.useEffect)((function(){o(function(){var e=document.location.hash.split("#")[1];if(e){var t=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');return i(!0),s(t.username.replace("%40","@")),t.access_token}return""}())}),[c]),Object(r.jsxs)("div",{id:"top-bar",class:"w-100 flex my-4 p-4 justify-between h-16 align-middle",children:[Object(r.jsx)("h3",{children:t?a:"Please Sign in"}),Object(r.jsxs)("div",{className:"flex flex-row ",children:[Object(r.jsx)("img",{src:I,alt:"Metro Saint Louis Logo"}),Object(r.jsx)("h2",{className:"text-2xl text-bold",children:"Metro Saint Louis"})]}),Object(r.jsx)("button",{id:"sign-in",class:"flex w-20",onClick:function(){var e="".concat("http://127.0.0.1:3001/"),t="".concat("S4vsIlw9pJcSZJnE");window.location.href="https://maps.metrostlouis.org/arcgis/sharing/rest/oauth2/authorize?client_id="+t+"&response_type=token&expiration=1440&redirect_uri="+window.encodeURIComponent(e)+"oauth-windowheight=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes"},children:Object(r.jsx)("img",{id:"sign-in-icon",src:R,alt:"signin"})})]})}var D=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),s=t[0],a=t[1],c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],u=o[1],d=Object(n.useState)(""),b=Object(i.a)(d,2),j=b[0],p=b[1];return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(F,{signedIn:s,user:l,setUser:u,token:j,setSignedIn:a,setToken:p}),Object(r.jsx)(N,{token:j})]})},E=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,113)).then((function(t){var s=t.getCLS,r=t.getFID,n=t.getFCP,a=t.getLCP,c=t.getTTFB;s(e),r(e),n(e),a(e),c(e)}))};o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(D,{})}),document.getElementById("root")),E()}},[[76,1,2]]]);
//# sourceMappingURL=main.42c67747.chunk.js.map